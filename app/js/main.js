(function(){var e,t,n,i,o,s,r,u,c,a,l,d,h,g,m,f,p,w,b,S;b=window.require("electron").ipcRenderer,g=require("vue"),f=require("vue-router"),m=require("vue-async-data"),S=require("moment"),l=require("./space.js"),s=require("../vues/Navbar.vue"),c=require("../vues/SignIn.vue"),a=require("../vues/SignUp.vue"),t=require("../vues/DeletePopup.vue"),r=require("../vues/Popup.vue"),d=require("../vues/Tasks.vue"),o=require("../vues/Mockups.vue"),i=require("../vues/Mockup.vue"),e=require("../vues/Chat.vue"),h=require("../vues/Teams.vue"),n=require("../vues/JoinTeam.vue"),u=require("../vues/Settings.vue"),g.config.debug=!0,window.init=function(){var l,p,w,v,T;return g.use(f),g.use(m),l=g.extend({data:function(){return{settings:{usability:{theme:"light",hasSchedule:!1,isColorblind:!1}},timer:null}},ready:function(){return document.querySelector("html").className="light",window.change=function(e){return function(t){var n;return 0===t&&(n="dark"),1===t&&(n="light"),e.switchTheme(n)}}(this),b.on("switchTheme",function(e){return function(t,n){return e.switchTheme(n),e.$broadcast("themeChanged",n),socket.emit("user.settings.write",e.settings)}}(this)),b.on("toggleTheme",function(e){return function(t){var n;return n="light"===e.settings.usability.theme?"dark":"light",e.switchTheme(n),socket.emit("user.settings.write",e.settings),e.$broadcast("themeChanged",n)}}(this)),b.on("toggleSchedule",function(e){return function(t,n){return e.toggleSchedule(n),socket.emit("user.settings.write",e.settings)}}(this)),b.on("navigateToSettings",function(e){return function(t,n){if(localStorage.getItem("userId"))return e.$router.go("/settings")}}(this)),b.on("toggleColorblind",function(e){return function(t,n){return e.toggleColorblind(n),socket.emit("user.settings.write",e.settings)}}(this))},watch:{theme:function(e,t){return this.switchTheme(e)}},methods:{switchTheme:function(e){var t;return this.settings.usability.theme=e,document.querySelector("html").className=e,localStorage.settings&&(t=JSON.parse(localStorage.settings),t.usability.theme=e,localStorage.settings=JSON.stringify(t)),localStorage.selectedTheme=e,b.send("updateTheme",e)},setCountdownToThemeSwitch:function(){var e,t,n,i,o,s;return s=S(),n=S().hour(8).minute(0).second(0),t=S().hour(20).minute(0).second(0),s.isBefore(n)&&(e=n.diff(s),i="light",o={title:"Good morning!",body:"Turning the lights on."}),s.isSameOrAfter(n)&&(e=t.diff(s),i="dark",o={title:"Itâ€˜s getting late...",body:"Turning the lights off."}),s.isSameOrAfter(t)&&(e=n.add(1,"d").diff(s),i="light",o={title:"Good morning!",body:"Turning the lights on..."}),this.timer=setTimeout(function(e){return function(){return new Notification(o.title,{body:o.body,silent:!0}),setTimeout(function(){return e.switchTheme(i),e.$broadcast("themeChanged",i)},500),e.setCountdownToThemeSwitch()}}(this),e)},toggleSchedule:function(e){return this.settings.usability.hasSchedule=e,localStorage.hasSchedule=e,e?this.setCountdownToThemeSwitch():clearTimeout(this.timer),this.$broadcast("scheduleChanged",e),b.send("updateSchedule",e)},toggleColorblind:function(e){var t;if(this.settings.usability.isColorblind=e,localStorage.settings)return t=JSON.parse(localStorage.settings),t.usability.isColorblind=e,localStorage.settings=JSON.stringify(t),this.$broadcast("toggleColorblind",e),b.send("updateColorblind",e)}},events:{clearUnreadMessageCount:function(){return this.$broadcast("clearUnreadMessageCount")},changeProject:function(e,t){return localStorage.selectedProject=t.uuid,localStorage.selectedTeam=e.uuid,socket.emit("user.join",[t.uuid,e.uuid]),this.$broadcast("changeProject",e,t)},leftTeam:function(e){return this.$broadcast("leftTeam",e)},logout:function(){return this.$broadcast("logout")},changeTheme:function(e){return this.switchTheme(e)},toggleSchedule:function(e){return this.toggleSchedule(e)},toggleColorblind:function(e){return this.toggleColorblind(e)},notificationPreferenceChanged:function(e,t){return this.$broadcast("notificationPreferenceChanged",e,t)},error:function(e){return this.$broadcast("newError",e)},userConnected:function(){var e;if(e=JSON.parse(localStorage.settings),this.switchTheme(e.usability.theme),b.send("updateTheme",this.settings.usability.theme),null!==e.usability.hasSchedule&&(this.settings.usability.hasSchedule=e.usability.hasSchedule,b.send("updateSchedule",this.settings.usability.hasSchedule)),this.settings.usability.hasSchedule&&this.setCountdownToThemeSwitch(),null!==e.usability.isColorblind)return this.toggleColorblind(e.usability.isColorblind),b.send("updateColorblind",e.usability.isColorblind)},setBadge:function(e){return b.send("setBadge",e)},bounceIcon:function(){return b.send("bounceIcon")}}}),w=g.component("navbar",s),c=g.component("signin-component",c),a=g.component("signup-component",a),p=g.component("delete-popup",t),v=g.component("popup",r),d=g.component("tasks-component",d),o=g.component("mockups-component",o),i=g.component("mockup-component",i),e=g.component("chat-component",e),h=g.component("teams-component",h),n=g.component("jointeam-component",n),u=g.component("settings-component",u),T=new f,T.redirect({"/":"/signin"}),T.map({"/signin":{component:c},"/signup":{component:a},"/tasks":{component:d},"/mockups":{component:o},"/mockups/:id":{component:i},"/chat":{component:e},"/teams":{component:h},"/joinTeam":{component:n},"/settings":{component:u}}),T.start(l,"#app"),socket.on("disconnect",function(e){return function(){return new Notification("Whoops! Connection lost.",{body:"Please wait a moment...",silent:!0})}}(this)),socket.on("reconnect",function(e){return function(){return socket.emit("user.rejoin",localStorage.userId,[localStorage.selectedProject,localStorage.selectedTeam,localStorage.userId]),new Notification("We're good!",{body:"Connection to server established.",silent:!0})}}(this))},"undefined"==typeof io?(window.starfield&&window.starfield.isRunning||(window.starfield=new l,window.starfield.animate=function(){return window.starfield.iAnimationRequestId=window.requestAnimationFrame(window.starfield.animate),window.starfield.render()},window.starfield.isRunning=!0,window.starfield.animate()),p=document.createElement("div"),p.classList.add("no-server"),w=document.createElement("p"),w.classList.add("no-server__message"),w.innerHTML="Could not reach server! <br>Retrying in 5 seconds...",p.appendChild(w),document.body.appendChild(p),setTimeout(function(e){return function(){return window.location.reload()}}(this),5e3)):window.init()}).call(this);